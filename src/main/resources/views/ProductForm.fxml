<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<VBox xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.hisabx.controller.ProductController"
      stylesheets="@../styles/main.css"
      spacing="16" prefWidth="500" prefHeight="650"
      style="-fx-background-color: #f8fafc; -fx-padding: 24; -fx-font-family: 'Geeza Pro', 'SF Arabic', 'Arial', 'Tahoma';">
    
    <Label text="إضافة / تعديل منتج" 
           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #1f3c56;"/>
    
    <GridPane hgap="12" vgap="12">
        <columnConstraints>
            <ColumnConstraints percentWidth="35"/>
            <ColumnConstraints percentWidth="65"/>
        </columnConstraints>
        
        <Label text="كود المنتج:" GridPane.rowIndex="0" GridPane.columnIndex="0" 
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="productCodeField" GridPane.rowIndex="0" GridPane.columnIndex="1"
                   promptText="سيتم توليده تلقائياً"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="اسم المنتج:*" GridPane.rowIndex="1" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="nameField" GridPane.rowIndex="1" GridPane.columnIndex="1"
                   promptText="أدخل اسم المنتج"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="الوصف:" GridPane.rowIndex="2" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextArea fx:id="descriptionField" GridPane.rowIndex="2" GridPane.columnIndex="1"
                  promptText="وصف المنتج (اختياري)" prefRowCount="2"
                  style="-fx-background-radius: 8; -fx-border-radius: 8;"/>
        
        <Label text="الفئة:" GridPane.rowIndex="3" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <HBox spacing="8" GridPane.rowIndex="3" GridPane.columnIndex="1">
            <ComboBox fx:id="categoryComboBox" HBox.hgrow="ALWAYS" maxWidth="Infinity"
                      promptText="اختر الفئة"
                      style="-fx-background-radius: 8; -fx-border-radius: 8;"/>
            <Button text="+" onAction="#handleAddCategory"
                    style="-fx-background-color: #2a8cff; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-min-width: 36;"/>
        </HBox>
        
        <Label text="الباركود:" GridPane.rowIndex="4" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="barcodeField" GridPane.rowIndex="4" GridPane.columnIndex="1"
                   promptText="أدخل الباركود (اختياري)"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="سعر التكلفة:*" GridPane.rowIndex="5" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="costPriceField" GridPane.rowIndex="5" GridPane.columnIndex="1"
                   promptText="0.00"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="طريقة التسعير:" GridPane.rowIndex="6" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <HBox spacing="12" GridPane.rowIndex="6" GridPane.columnIndex="1">
            <RadioButton fx:id="manualPriceRadio" text="سعر يدوي" selected="true"
                        style="-fx-font-size: 13px;"/>
            <RadioButton fx:id="percentagePriceRadio" text="نسبة مئوية"
                        style="-fx-font-size: 13px;"/>
        </HBox>
        
        <Label text="سعر البيع:*" GridPane.rowIndex="7" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <HBox spacing="8" GridPane.rowIndex="7" GridPane.columnIndex="1">
            <TextField fx:id="unitPriceField" HBox.hgrow="ALWAYS"
                       promptText="0.00"
                       style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
            <TextField fx:id="profitPercentageField" HBox.hgrow="ALWAYS" visible="false" managed="false"
                       promptText="نسبة الربح %"
                       style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        </HBox>
        
        <Label text="هامش الربح:" GridPane.rowIndex="8" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <Label fx:id="profitMarginLabel" GridPane.rowIndex="8" GridPane.columnIndex="1"
               text="0.00 د.ع (0%)"
               style="-fx-font-size: 14px; -fx-text-fill: #10b981; -fx-font-weight: bold;"/>
        
        <Label text="الكمية في المخزون:" GridPane.rowIndex="9" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="quantityField" GridPane.rowIndex="9" GridPane.columnIndex="1"
                   promptText="0"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="الحد الأدنى للمخزون:" GridPane.rowIndex="10" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="minimumStockField" GridPane.rowIndex="10" GridPane.columnIndex="1"
                   promptText="0"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="الحد الأقصى للمخزون:" GridPane.rowIndex="11" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <TextField fx:id="maximumStockField" GridPane.rowIndex="11" GridPane.columnIndex="1"
                   promptText="غير محدد"
                   style="-fx-background-radius: 8; -fx-border-radius: 8; -fx-padding: 10;"/>
        
        <Label text="وحدة القياس:" GridPane.rowIndex="12" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <ComboBox fx:id="unitOfMeasureComboBox" GridPane.rowIndex="12" GridPane.columnIndex="1"
                  maxWidth="Infinity" promptText="اختر وحدة القياس"
                  style="-fx-background-radius: 8; -fx-border-radius: 8;"/>
        
        <Label text="الحالة:" GridPane.rowIndex="13" GridPane.columnIndex="0"
               style="-fx-font-size: 14px; -fx-text-fill: #374151;"/>
        <CheckBox fx:id="isActiveCheckBox" GridPane.rowIndex="13" GridPane.columnIndex="1"
                  text="نشط" selected="true"
                  style="-fx-font-size: 14px;"/>
    </GridPane>
    
    <Region VBox.vgrow="ALWAYS"/>
    
    <HBox spacing="12" alignment="CENTER_LEFT">
        <Button text="حفظ" onAction="#handleSave" prefWidth="120"
                style="-fx-background-color: linear-gradient(to right, #2a8cff, #246bff); -fx-text-fill: white; -fx-font-size: 14px; -fx-font-weight: bold; -fx-padding: 12 24; -fx-background-radius: 10;"/>
        <Button text="إلغاء" onAction="#handleCancel" prefWidth="100"
                style="-fx-background-color: #e5e7eb; -fx-text-fill: #374151; -fx-font-size: 14px; -fx-padding: 12 24; -fx-background-radius: 10;"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button fx:id="deleteButton" text="حذف" onAction="#handleDelete" prefWidth="100" visible="false"
                style="-fx-background-color: #ef4444; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 12 24; -fx-background-radius: 10;"/>
    </HBox>
</VBox>
