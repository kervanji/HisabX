<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.FlowPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.Separator?>
<?import javafx.geometry.Insets?>
<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.hisabx.controller.MainController" fx:id="mainLayout"
           stylesheets="@../styles/main.css"
           style="-fx-background-color: #0f1b2d;">

    <center>
        <TabPane fx:id="mainTabPane" styleClass="dashboard-tab-pane">
            <tabs>
                <Tab fx:id="dashboardTab" text="Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©" closable="false">
                    <content>
                        <BorderPane style="-fx-background-color: #0f1b2d;">
                            <!-- Top Header Bar -->
                            <top>
                                <HBox alignment="CENTER" spacing="12"
                                      style="-fx-padding: 12 24; -fx-background-color: #0f1b2d; -fx-border-color: rgba(255,255,255,0.06); -fx-border-width: 0 0 1 0;">
                                    <ImageView fitWidth="36" fitHeight="36" preserveRatio="true">
                                        <image>
                                            <Image url="@../templates/HisabX_transparent.png"/>
                                        </image>
                                    </ImageView>
                                    <Label text="HisabX" style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: white;">
                                        <font><Font name="Segoe UI Bold" size="22"/></font>
                                    </Label>
                                    <Label fx:id="companyNameLabel" text="" style="-fx-font-size: 13px; -fx-text-fill: #64b5f6; -fx-font-weight: 600;">
                                        <font><Font name="Segoe UI Semibold" size="13"/></font>
                                    </Label>
                                    <Region HBox.hgrow="ALWAYS"/>
                                    <!-- Layout Edit Controls (Admin only) -->
                                    <HBox fx:id="layoutEditControls" alignment="CENTER" spacing="6" visible="false" managed="false">
                                        <Button fx:id="editLayoutBtn" text="âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©" onAction="#handleToggleEditMode" styleClass="header-btn" style="-fx-background-color: rgba(255,193,7,0.15); -fx-text-fill: #ffd54f;"/>
                                        <Button fx:id="sellerLayoutBtn" text="ðŸ›ï¸ ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹" onAction="#handleToggleSellerEditMode" styleClass="header-btn" style="-fx-background-color: rgba(59,130,246,0.18); -fx-text-fill: #bfdbfe;"/>
                                        <Button fx:id="resetLayoutBtn" text="â†º Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨" onAction="#handleResetLayout" styleClass="header-btn" style="-fx-background-color: rgba(244,67,54,0.15); -fx-text-fill: #ef9a9a;" visible="false" managed="false"/>
                                    </HBox>
                                    <!-- User Info -->
                                    <HBox alignment="CENTER" spacing="8">
                                        <Label fx:id="currentUserLabel" text="" style="-fx-font-size: 13px; -fx-text-fill: #e0e0e0; -fx-font-weight: 600;"/>
                                        <Label fx:id="currentRoleLabel" text="" style="-fx-font-size: 11px; -fx-text-fill: #90caf9; -fx-background-color: rgba(66,165,245,0.15); -fx-padding: 3 10; -fx-background-radius: 12;"/>
                                        <Button fx:id="lockButton" text="Ù‚ÙÙ„" onAction="#handleLock" styleClass="header-btn" style="-fx-background-color: rgba(255,193,7,0.15); -fx-text-fill: #ffd54f;"/>
                                        <Button fx:id="logoutButton" text="Ø®Ø±ÙˆØ¬" onAction="#handleLogout" styleClass="header-btn" style="-fx-background-color: rgba(244,67,54,0.15); -fx-text-fill: #ef9a9a;"/>
                                    </HBox>
                                </HBox>
                            </top>

                            <center>
                                <ScrollPane fitToWidth="true" hbarPolicy="NEVER" style="-fx-background: transparent; -fx-background-color: transparent;">
                                    <VBox alignment="TOP_CENTER" spacing="24" style="-fx-padding: 30 40;">

                                        <!-- Statistics Cards Row -->
                                        <HBox alignment="CENTER" spacing="16">
                                            <VBox alignment="CENTER" spacing="6" styleClass="stat-card" style="-fx-background-color: linear-gradient(to bottom right, #1e3a5f, #234b7a); -fx-background-radius: 16; -fx-padding: 18 24; -fx-pref-width: 200; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 12,0,0,4);">
                                                <Label text="Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…" style="-fx-font-size: 12px; -fx-text-fill: #90caf9;"/>
                                                <Label fx:id="todaySalesAmountLabel" text="0 Ø¯.Ø¹" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #4fc3f7;"/>
                                                <Label fx:id="todaySalesCountLabel" text="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: --" style="-fx-font-size: 11px; -fx-text-fill: #78909c;"/>
                                            </VBox>
                                            <VBox alignment="CENTER" spacing="6" styleClass="stat-card" style="-fx-background-color: linear-gradient(to bottom right, #1e3a5f, #234b7a); -fx-background-radius: 16; -fx-padding: 18 24; -fx-pref-width: 200; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 12,0,0,4);">
                                                <Label text="Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡" style="-fx-font-size: 12px; -fx-text-fill: #90caf9;"/>
                                                <Label fx:id="totalCustomersLabel" text="--" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #7c4dff;"/>
                                            </VBox>
                                            <VBox alignment="CENTER" spacing="6" styleClass="stat-card" style="-fx-background-color: linear-gradient(to bottom right, #1e3a5f, #234b7a); -fx-background-radius: 16; -fx-padding: 18 24; -fx-pref-width: 200; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 12,0,0,4);">
                                                <Label text="Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª" style="-fx-font-size: 12px; -fx-text-fill: #90caf9;"/>
                                                <Label fx:id="totalProductsLabel" text="--" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #66bb6a;"/>
                                            </VBox>
                                            <VBox alignment="CENTER" spacing="6" styleClass="stat-card" style="-fx-background-color: linear-gradient(to bottom right, #1e3a5f, #234b7a); -fx-background-radius: 16; -fx-padding: 18 24; -fx-pref-width: 200; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 12,0,0,4);">
                                                <Label text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª" style="-fx-font-size: 12px; -fx-text-fill: #90caf9;"/>
                                                <Label fx:id="totalSalesLabel" text="--" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #ffa726;"/>
                                            </VBox>
                                            <VBox alignment="CENTER" spacing="6" styleClass="stat-card" style="-fx-background-color: linear-gradient(to bottom right, #1e3a5f, #234b7a); -fx-background-radius: 16; -fx-padding: 18 24; -fx-pref-width: 200; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 12,0,0,4);">
                                                <Label text="Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" style="-fx-font-size: 12px; -fx-text-fill: #90caf9;"/>
                                                <Label fx:id="inventoryValueLabel" text="--" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #ef5350;"/>
                                            </VBox>
                                        </HBox>

                                        <!-- Alert Cards -->
                                        <HBox alignment="CENTER" spacing="16">
                                            <HBox alignment="CENTER_RIGHT" spacing="10" style="-fx-background-color: linear-gradient(to right, #1a3050, #1e3a5f); -fx-background-radius: 12; -fx-padding: 12 20; -fx-pref-width: 350; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 8,0,0,3);">
                                                <VBox alignment="CENTER_RIGHT" spacing="4" HBox.hgrow="ALWAYS">
                                                    <Label text="ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" style="-fx-font-size: 13px; -fx-font-weight: bold; -fx-text-fill: #ffab91;"/>
                                                    <Label fx:id="lowStockDescLabel" text="Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" style="-fx-font-size: 11px; -fx-text-fill: #78909c;"/>
                                                    <Label fx:id="lowStockCountLabel" text="Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª" style="-fx-font-size: 12px; -fx-font-weight: 600; -fx-text-fill: #66bb6a; -fx-background-color: rgba(102,187,106,0.15); -fx-padding: 4 10; -fx-background-radius: 8;"/>
                                                </VBox>
                                            </HBox>
                                            <HBox alignment="CENTER_RIGHT" spacing="10" style="-fx-background-color: linear-gradient(to right, #1a3050, #1e3a5f); -fx-background-radius: 12; -fx-padding: 12 20; -fx-pref-width: 350; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 8,0,0,3);">
                                                <VBox alignment="CENTER_RIGHT" spacing="4" HBox.hgrow="ALWAYS">
                                                    <Label text="Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©" style="-fx-font-size: 13px; -fx-font-weight: bold; -fx-text-fill: #ffe082;"/>
                                                    <Label fx:id="pendingPaymentsDescLabel" text="ÙÙˆØ§ØªÙŠØ± ØªÙ†ØªØ¸Ø± Ø§Ù„Ø¯ÙØ¹" style="-fx-font-size: 11px; -fx-text-fill: #78909c;"/>
                                                    <Label fx:id="pendingPaymentsLabel" text="0 ÙØ§ØªÙˆØ±Ø©" style="-fx-font-size: 12px; -fx-font-weight: 600; -fx-text-fill: #ffa726; -fx-background-color: rgba(255,167,38,0.15); -fx-padding: 4 10; -fx-background-radius: 8;"/>
                                                </VBox>
                                            </HBox>
                                        </HBox>

                                        <!-- Tiles Grid - built programmatically by MainController -->
                                        <FlowPane fx:id="tilesFlowPane" hgap="16" vgap="16" alignment="CENTER" nodeOrientation="RIGHT_TO_LEFT">
                                        </FlowPane>
                                    </VBox>
                                </ScrollPane>
                            </center>
                        </BorderPane>
                    </content>
                </Tab>
            </tabs>
        </TabPane>
    </center>

    <bottom>
        <HBox alignment="CENTER" spacing="16" style="-fx-padding: 8 20; -fx-background-color: #0f1b2d; -fx-border-color: rgba(255,255,255,0.06); -fx-border-width: 1 0 0 0;">
            <HBox alignment="CENTER_LEFT" spacing="8" HBox.hgrow="ALWAYS">
                <Button fx:id="checkUpdateButton" text="ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª" onAction="#handleCheckForUpdates" styleClass="header-btn" style="-fx-background-color: rgba(33,150,243,0.15); -fx-text-fill: #64b5f6;"/>
                <Label fx:id="updateStatusLabel" text="" style="-fx-font-size: 11px; -fx-text-fill: #78909c; -fx-font-weight: 600;"/>
                <ProgressIndicator fx:id="updateProgress" visible="false" prefWidth="16" prefHeight="16"/>
                <Button fx:id="updateButton" text="ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†" visible="false" onAction="#handleUpdateNow" styleClass="header-btn" style="-fx-background-color: rgba(33,150,243,0.25); -fx-text-fill: #90caf9;"/>
            </HBox>
            <Label text="Â© 2025 KervanjiHolding" style="-fx-font-size: 11px; -fx-text-fill: #546e7a;"/>
            <Label text="â€¢" style="-fx-font-size: 11px; -fx-text-fill: #37474f;"/>
            <Label text="HisabX v1.0.9" style="-fx-font-size: 11px; -fx-text-fill: #78909c; -fx-font-weight: 600;"/>
        </HBox>
    </bottom>
</BorderPane>
